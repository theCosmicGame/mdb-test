import t from"clsx";import n,{useRef as e,useState as o,useCallback as r,useEffect as c}from"react";var i=function(){return i=Object.assign||function(t){for(var n,e=1,o=arguments.length;e<o;e++)for(var r in n=arguments[e])Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r]);return t},i.apply(this,arguments)};function l(t){var n=function(t){var n=t.getBoundingClientRect();return{top:n.top+document.body.scrollTop,left:n.left+document.body.scrollLeft}}(t),e=t.getBoundingClientRect(),o=0===n.left&&0===n.top?0:window.innerHeight-e.bottom;return i(i({},n),{bottom:o})}var u=function(u){var a=u.className,p=u.stickyRef,f=u.animationSticky,s=u.animationUnsticky,d=u.boundary,h=u.delay,m=u.direction,g=u.offset,y=u.position,v=u.tag,b=u.children,w=u.onActive,x=u.onInactive,O=function(t,n){var e={};for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&n.indexOf(o)<0&&(e[o]=t[o]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(o=Object.getOwnPropertySymbols(t);r<o.length;r++)n.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(t,o[r])&&(e[o[r]]=t[o[r]])}return e}(u,["className","stickyRef","animationSticky","animationUnsticky","boundary","delay","direction","offset","position","tag","children","onActive","onInactive"]),E=e(null),k=e(null),R=p||E,j=e(""),B=e(!1),C=e(0),I=e(0),z=e(0),L=o(),P=L[0],T=L[1],N=o(),S=N[0],A=N[1],H=o(!1),U=H[0],F=H[1],Y=o({}),q=Y[0],D=Y[1],G=o(!1),J=G[0],K=G[1],M=t("sticky",f&&U&&"animation ".concat(f),s&&J&&"animation ".concat(s),a),Q=r((function(){var t=k.current,n=R.current;C.current=t?t.offsetTop:n.offsetTop}),[R]),V=r((function(){var t=R.current;t&&(z.current="top"===y?C.current-h:C.current+t.height-document.body.scrollHeight+h)}),[h,y,R]),W=r((function(t){t>I.current?j.current="down":j.current="up"}),[]),X=function(t,n){Object.keys(n).forEach((function(e){t.style[e]=n[e]}))},Z=r((function(){var t=k.current,n=R.current;if(t){var e=t.getBoundingClientRect().left;D({left:"".concat(e,"px")})}else D({});X(n,q),Q()}),[Q,q,R]),$=r((function(){var t,n=R.current,e=g,o=n.getBoundingClientRect().height,r=i({height:n.parentElement.getBoundingClientRect().height},l(n.parentElement)),c="boolean"!=typeof d&&(null==d?void 0:d.current);t=c?l(c).top-o-e:r.height+r[y]-o-e;var u,a="top"===y,p="bottom"===y,f=d,s=t<0,h=t>r.height-o;a&&(u=s&&f?{top:"".concat(e+t,"px")}:{top:"".concat(e+0,"px")}),p&&(u=s&&f?{bottom:"".concat(e+t,"px")}:h&&f?{bottom:"".concat(g+r.bottom,"px")}:{bottom:"".concat(e+0,"px")}),X(n,u)}),[d,g,y,R]),_=r((function(){var t=window.pageYOffset||document.documentElement.scrollTop,n=g;Q(),V(),W(t);var e=[j.current,"both"].includes(m),o=z.current<=t,r=o&&!B.current&&e,c=(!o||!e)&&B.current;if(r){var i=R.current.getBoundingClientRect(),l=i.height,u=i.left,a=i.width;w&&w(),F(!0),A({height:"".concat(l,"px"),width:"".concat(a,"px"),opacity:"0"}),T({top:"top"===y?"".concat(0+n,"px"):null,bottom:"bottom"===y?"".concat(0+n,"px"):null,height:"".concat(l,"px"),width:"".concat(a,"px"),left:"".concat(u,"px"),zIndex:"100",position:"fixed"}),$(),B.current=!0}c&&(x&&x(),s?(K(!0),setTimeout((function(){T({top:null,bottom:null,position:null,left:null,zIndex:null,width:null,height:null}),F(!1),A({height:null,width:null,opacity:null}),K(!1)}),200)):(T({top:null,bottom:null,position:null,left:null,zIndex:null,width:null,height:null}),F(!1),A({height:null,width:null,opacity:null})),B.current=!1),B.current&&(X(R.current,q),$()),I.current=t<=0?0:t}),[m,Q,V,W,g,y,R,q,$,s,w,x]);return c((function(){return window.addEventListener("resize",Z),window.addEventListener("scroll",_),function(){window.removeEventListener("resize",Z),window.removeEventListener("scroll",_)}}),[Z,_]),n.createElement(n.Fragment,null,U&&n.createElement(v,i({className:M,ref:k,style:S},O),b),n.createElement(v,i({className:M,ref:R,style:P},O),b))};u.defaultProps={tag:"span",delay:0,direction:"down",offset:0,position:"top"};export{u as default};
