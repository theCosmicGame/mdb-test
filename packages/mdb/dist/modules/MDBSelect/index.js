"use strict";var e=require("clsx"),t=require("react"),a=require("react-popper"),n=require("react-dom");function l(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var r=l(e),c=l(t),i=l(n),u=function(){return u=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var l in t=arguments[a])Object.prototype.hasOwnProperty.call(t,l)&&(e[l]=t[l]);return e},u.apply(this,arguments)};function o(e,t){var a={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(a[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var l=0;for(n=Object.getOwnPropertySymbols(e);l<n.length;l++)t.indexOf(n[l])<0&&Object.prototype.propertyIsEnumerable.call(e,n[l])&&(a[n[l]]=e[n[l]])}return a}function s(e,t){for(var a=0,n=t.length,l=e.length;a<n;a++,l++)e[l]=t[a];return e}var d=function(e){var a,n=e.className,l=e.size,i=e.contrast,s=e.value,d=e.defaultValue,f=e.id,p=e.labelClass,m=e.wrapperClass,v=e.wrapperStyle,h=e.wrapperTag,b=e.label,g=e.onChange,E=e.children,y=e.labelRef,N=e.labelStyle,x=e.inputRef,w=e.type,S=e.onBlur,C=e.readonly,k=o(e,["className","size","contrast","value","defaultValue","id","labelClass","wrapperClass","wrapperStyle","wrapperTag","label","onChange","children","labelRef","labelStyle","inputRef","type","onBlur","readonly"]),T=t.useState(s||d),L=T[0],R=T[1],O=t.useState(0),P=O[0],A=O[1],F=t.useState(!(!s&&!d)),j=F[0],B=F[1],I=t.useRef(null),z=t.useRef(null),W=y||I,q=x||z,D=r.default("form-outline",i&&"form-white",m),H=r.default("form-control",j&&"active","date"===w&&"active",l&&"form-control-".concat(l),n),V=r.default("form-label",p);t.useEffect((function(){void 0!==s&&B(!!s)}),[s]),t.useEffect((function(){void 0!==d&&B(!!d)}),[d]);var M=t.useCallback((function(){var e;(null===(e=W.current)||void 0===e?void 0:e.clientWidth)&&A(.8*W.current.clientWidth+8)}),[W]);t.useEffect((function(){M()}),[null===(a=W.current)||void 0===a?void 0:a.clientWidth,M]);return c.default.createElement(h,{className:D,style:v},c.default.createElement("input",u({type:w,readOnly:C,className:H,onBlur:function(e){B(""!==L),null==S||S(e)},onChange:function(e){R(e.target.value),null==g||g(e)},onFocus:M,value:s,defaultValue:d,id:f,ref:q},k)),b&&c.default.createElement("label",{className:V,style:N,htmlFor:f,ref:W},b),c.default.createElement("div",{className:"form-notch"},c.default.createElement("div",{className:"form-notch-leading"}),c.default.createElement("div",{className:"form-notch-middle",style:{width:P}}),c.default.createElement("div",{className:"form-notch-trailing"})),E)};d.defaultProps={wrapperTag:"div",readonly:!1};var f=c.default.forwardRef((function(e,t){var a=e.className,n=e.open,l=e.tag,i=e.children,s=o(e,["className","open","tag","children"]),d=r.default("select-dropdown",n&&"open",a);return c.default.createElement(l,u({className:d},s,{ref:t}),i)}));f.defaultProps={tag:"div"};var p=c.default.forwardRef((function(e,t){var a=e.className,n=e.tag,l=e.children,i=o(e,["className","tag","children"]),s=r.default("select-option-icon-container",a);return c.default.createElement(n,u({className:s},i,{ref:t}),l)}));p.defaultProps={tag:"span"};var m=function(e){var t=e.className,a=e.inputRef,n=e.labelClass,l=e.wrapperClass,i=e.labelStyle,s=e.wrapperTag,d=e.wrapperStyle,f=e.label,p=e.inline,m=e.btn,v=e.id,h=e.btnColor,b=e.disableWrapper,g=e.toggleSwitch,E=o(e,["className","inputRef","labelClass","wrapperClass","labelStyle","wrapperTag","wrapperStyle","label","inline","btn","id","btnColor","disableWrapper","toggleSwitch"]),y="form-check-input",N="form-check-label";m&&(y="btn-check",N=h?"btn btn-".concat(h):"btn btn-primary");var x=r.default(f&&!m&&"form-check",p&&!m&&"form-check-inline",g&&"form-switch",l),w=r.default(y,t),S=r.default(N,n),C=c.default.createElement(c.default.Fragment,null,c.default.createElement("input",u({className:w,id:v,ref:a},E)),f&&c.default.createElement("label",{className:S,style:i,htmlFor:v},f));return c.default.createElement(c.default.Fragment,null,b?C:c.default.createElement(s,{style:d,className:x},C))};m.defaultProps={wrapperTag:"div"};var v=function(e){var t=o(e,[]);return c.default.createElement(m,u({type:"checkbox"},t))},h=function(e){var a=e.className,n=e.tag,l=e.disabled,i=e.height,s=e.active,d=e.children,f=e.selected,p=e.style,m=e.secondaryText,h=e.text,b=e.revert,g=e.onClick,E=e.multiple,y=o(e,["className","tag","disabled","height","active","children","selected","style","secondaryText","text","revert","onClick","multiple"]),N=r.default(void 0!==a&&(null==a?void 0:a.includes("select-no-results"))?"":"select-option",f&&"selected",l&&"disabled",s&&"active",a),x=t.useState(i),w=x[0],S=x[1],C=t.useState(!1),k=C[0],T=C[1];t.useEffect((function(){m&&void 0===i?S(44):void 0===i&&S(38)}),[m,i]);var L=t.useCallback((function(e){l||(g&&g(e),T(!k))}),[k,l,g]);return t.useEffect((function(){E&&T(!(!f||l))}),[f,l,E]),c.default.createElement(n,u({className:N,style:u({height:w},p),onClick:L},y,{role:"option"}),b?c.default.createElement(c.default.Fragment,null,d,c.default.createElement("div",{className:"select-option-text"},E&&c.default.createElement(v,{label:h,onChange:L,checked:k,disabled:l}),!E&&h,m&&c.default.createElement("span",{className:"select-option-secondary-text"},m))):c.default.createElement(c.default.Fragment,null,c.default.createElement("div",{className:"select-option-text"},E&&c.default.createElement(v,{label:h,onChange:L,checked:k,disabled:l}),!E&&h,m&&c.default.createElement("span",{className:"select-option-secondary-text"},m)),d))};h.defaultProps={tag:"span",revert:!1};var b=c.default.forwardRef((function(e,t){var a=e.className,n=e.tag,l=e.children,i=o(e,["className","tag","children"]),s=r.default("select-option-icon",a);return c.default.createElement(n,u({className:s},i,{ref:t}),l)}));b.defaultProps={tag:"img"};var g=c.default.forwardRef((function(e,t){var a=e.className,n=e.tag,l=e.children,i=o(e,["className","tag","children"]),s=r.default("select-options-list",a);return c.default.createElement(n,u({className:s},i,{ref:t}),l)}));g.defaultProps={tag:"div"};var E=c.default.forwardRef((function(e,t){var a=e.className,n=e.tag,l=e.children,i=e.maxHeight,s=o(e,["className","tag","children","maxHeight"]),d=r.default("select-options-wrapper",a);return c.default.createElement(n,u({className:d,style:{maxHeight:i}},s,{ref:t}),l)}));E.defaultProps={tag:"div"};!function(e,t){void 0===t&&(t={});var a=t.insertAt;if(e&&"undefined"!=typeof document){var n=document.head||document.getElementsByTagName("head")[0],l=document.createElement("style");l.type="text/css","top"===a&&n.firstChild?n.insertBefore(l,n.firstChild):n.appendChild(l),l.styleSheet?l.styleSheet.cssText=e:l.appendChild(document.createTextNode(e))}}(".select-input-label-active {\n  color: #1266f1 !important;\n}\n");var y=function(e){var n=e.children,l=e.className,m=e.clearBtn,v=e.data,y=e.tag,N=e.tagWrapper,x=e.visibleOptions,w=e.placeholder,S=e.disabled,C=e.search,k=e.getValue,T=e.multiple,L=e.optionSelected,R=e.optionsSelectedLabel,O=e.label,P=e.getData,A=e.selectAllLabel,F=e.noResultLabel,j=e.searchLabel,B=e.size,I=e.validation,z=e.validFeedback,W=e.invalidFeedback,q=e.inputClassName,D=e.searchAriaLabel,H=o(e,["children","className","clearBtn","data","tag","tagWrapper","visibleOptions","placeholder","disabled","search","getValue","multiple","optionSelected","optionsSelectedLabel","label","getData","selectAllLabel","noResultLabel","searchLabel","size","validation","validFeedback","invalidFeedback","inputClassName","searchAriaLabel"]),V=t.useState(!1),M=V[0],U=V[1],K=t.useState(""),G=K[0],J=K[1],Q=t.useState(!1),X=Q[0],Y=Q[1],Z=t.useState(!1),$=Z[0],_=Z[1],ee=t.useState(""),te=ee[0],ae=ee[1],ne=t.useRef(null),le=t.useState(null),re=le[0],ce=le[1],ie=t.useState(v),ue=ie[0],oe=ie[1],se=t.useState(""),de=se[0],fe=se[1],pe=t.useState(!1),me=pe[0],ve=pe[1],he=t.useState([]),be=he[0],ge=he[1],Ee=t.useState(!1),ye=Ee[0],Ne=Ee[1],xe=t.useState(v),we=xe[0],Se=xe[1],Ce=t.useState(),ke=Ce[0],Te=Ce[1],Le=t.useState(),Re=Le[0],Oe=Le[1],Pe=t.useState(ue.findIndex((function(e){return!e.disabled&&e.selected}))),Ae=Pe[0],Fe=Pe[1],je=t.useRef(null),Be=t.useState(!1),Ie=Be[0],ze=Be[1],We=t.useRef(null),qe=t.useState(0),De=qe[0],He=qe[1],Ve=t.useState(!1),Me=Ve[0],Ue=Ve[1],Ke=t.useState(!1),Ge=Ke[0],Je=Ke[1],Qe=t.useRef(null),Xe=a.usePopper(ke,Re,{placement:"bottom-start"}),Ye=Xe.styles,Ze=Xe.attributes,$e=r.default("select-wrapper",l),_e=r.default("select-input",w&&"placeholder-active",me&&O&&"active",M&&"focused","default"!==B&&"form-control-".concat(B),q);t.useEffect((function(){oe(v),Se(v);var e=v.filter((function(e){return!0===e.selected&&!e.disabled}));e.length>0&&ae(e[0].text)}),[v]),t.useEffect((function(){var e=[];ue.forEach((function(t){t.selected&&e.push({text:t.text,value:t.value})})),k&&e&&k(T?e:e[0])}),[te]),t.useEffect((function(){X&&C&&setTimeout((function(){var e;null===(e=We.current)||void 0===e||e.focus()}),100)}),[X,C]);var et=t.useCallback((function(){null!=ke&&X&&setTimeout((function(){var e,t=null===(e=ke.parentNode)||void 0===e?void 0:e.parentNode.getBoundingClientRect();J(t.width)}),100)}),[ke,X]);t.useEffect((function(){var e,t;if(z&&W&&ke){if(z){var a=document.createElement("div");a.classList.add("valid-feedback"),a.innerHTML=z,ke.setAttribute("required","true"),null===(e=ke.parentNode)||void 0===e||e.insertBefore(a,ke.nextSibling)}if(W){var n=document.createElement("div");n.classList.add("invalid-feedback"),n.innerHTML=W,ke.setAttribute("required","true"),null===(t=ke.parentNode)||void 0===t||t.insertBefore(n,ke.nextSibling)}}}),[z,W,ke]),t.useEffect((function(){et()}),[et]);var tt=t.useCallback((function(e){Re&&null!==Re&&M&&ke&&null!==ke&&(Re.contains(e.target)||ke.contains(e.target)?ve(!0):(U(!1),ve(!1),C&&setTimeout((function(){fe("")}),100)))}),[M,Re,ke,C]),at=t.useCallback((function(){U(!M),C&&fe("")}),[M,C]);t.useEffect((function(){if(Ie&&!X&&void 0!==De)if(T)U(!0);else{var e=v.map((function(e,t){return u(u({},e),t===De?{selected:!0,active:!0}:{selected:!1,active:!1})}));De<=0?ae(e[0].text):De>=e.length-1?ae(e[e.length-1].text):ae(e[De].text);for(var t=[],a=function(a){t.push(u(u({},v[a]),e.find((function(e){return e.text===v[a].text}))))},n=0;n<v.length;n++)a(n);P&&P(t),Se(t),oe(t)}return function(){clearTimeout(undefined)}}),[De]),t.useEffect((function(){var e,t;return M?(Y(!0),O&&ve(!0),t=setTimeout((function(){_(!0)}),100)):(e=setTimeout((function(){Y(!1)}),100),O&&ve(!1),_(!1)),function(){clearTimeout(e),clearTimeout(t)}}),[M,O]),t.useEffect((function(){if(T)if(ye){var e=ue.map((function(e){return u(u({},e),{selected:!0,active:!0})}));oe(e);var t=e.filter((function(e){return!e.disabled})).map((function(e){return e.text}));ge(t),ae("".concat(t.length," option").concat(t.length<=1?"":"s"," selected"))}else{oe(we);t=we.filter((function(e){return!e.disabled&&e.selected})).map((function(e){return e.text}));ge(t),ae("".concat(t.length," option").concat(t.length<=1?"":"s"," selected"))}}),[ye]),t.useEffect((function(){T&&(be.length>=Number(L)?ae(R||"".concat(be.length," option").concat(be.length<=1?"":"s"," selected")):ae(be.join(", ")))}),[be,T,L,R]),t.useEffect((function(){if(T){t=v.map((function(e){return void 0===e.selected?u(u({},e),{active:!1,selected:!1}):u(u({},e),{active:!0})}));oe(t);var e=we.filter((function(e){return!0===e.selected&&!e.disabled})).map((function(e){return e.text}));ge(e),be.length>=Number(L)?ae("".concat(be.length," option").concat(be.length<=1?"":"s"," selected")):ae(be.join(", "))}else{var t,a=(t=ue.map((function(e){return void 0===e.selected?u(u({},e),{active:!1,selected:!1}):u(u({},e),{active:!0})}))).filter((function(e){return!0===e.selected&&!e.disabled}));a.length>0&&(oe(t),ae(a[0].text)),P&&P(t)}}),[]),t.useEffect((function(){return X&&window.addEventListener("resize",et),function(){window.removeEventListener("resize",et)}}),[et,X]),t.useEffect((function(){return X&&window.addEventListener("click",tt),function(){window.removeEventListener("click",tt)}}),[tt,X]);var nt=t.useCallback((function(e,t,a){return void 0===a&&(a=x),s([],e).slice(0,a).forEach((function(e){var a=getComputedStyle(e).height;t.push(parseFloat(a))})),t}),[x]);t.useEffect((function(){var e,t;if(X){var a=null===(e=ne.current)||void 0===e?void 0:e.children,n=[];t=setTimeout((function(){void 0!==a&&(nt(a,n),ce(n.reduce((function(e,t){return e+t}))))}),0)}return function(){clearTimeout(t)}}),[X,x,nt]);var lt=t.useCallback((function(e,t){var a=e.disabled,n=e.className,l=e.text,r=e.selected;if(!(a||void 0!==n&&n.includes("select-no-results")))if(T)ue[t].selected=!ue[t].selected,oe(ue),Se(ue),void 0===l||r&&void 0!==r?void 0!==l&&r&&ge(be.filter((function(e){return e!==l}))):ge(s(s([],be),[l]));else{Fe(t),ae(l),U(!1);for(var c=ue.map((function(e,a){return a!==t?(e.selected=!1,e.active=!1):(e.selected=!0,e.active=!0),e})),i=v.map((function(e){return u(u({},e),{active:!1,selected:!1})})),o=[],d=function(e){o.push(u(u({},i[e]),c.find((function(t){return t.text===i[e].text}))))},f=0;f<i.length;f++)d(f);oe(o),Se(o),P&&P(o)}}),[v,ue,P,T,be]),rt=t.useCallback((function(e,t,a){var n=0;return a?((n=e-1)<0&&(n=0),t[n].disabled&&(n=rt(n,t,!0))):((n=e+1)>t.length-1&&(n=t.length-1),t[n].disabled&&(n=rt(n,t,!1))),n}),[]),ct=t.useCallback((function(e){var t=e.key;if("Escape"===t||"ArrowDown"===t||"ArrowUp"===t||"Enter"===t){var a,n,l;if(e.preventDefault(),"Escape"===t&&(a=setTimeout((function(){Y(!1),C&&fe("")}),100),U(!1),_(!1)),"ArrowDown"===t){var r=X?ue.findIndex((function(e){return e.active})):ue.findIndex((function(e){return e.selected})),c=rt(r,ue,!1);X?(Ue(!1),Je(!0),Fe(c)):He(c)}if("ArrowUp"===t){r=X?ue.findIndex((function(e){return e.active})):ue.findIndex((function(e){return e.selected})),c=rt(r,ue,!0);X?(Ue(!0),Je(!1),Fe(c)):He(c)}if("Enter"===t)if(X)if(T){r=ue.findIndex((function(e){return e.active}));lt(ue[r],r)}else{l=setTimeout((function(){Y(!1),C&&fe("")}),100);var i=ue.filter((function(e){return e.active&&!e.disabled}))[0],o=ue.findIndex((function(e){return e.active&&!e.disabled})),s=we.map((function(e,t){return u(u({},e),t===o?{selected:!0}:{selected:!1})}));ae(i.text),U(!1),_(!1),oe(s),Se(s)}else n=setTimeout((function(){Y(!0),U(!0),_(!0)}),100);return function(){clearTimeout(a),clearTimeout(n),clearTimeout(l)}}}),[C,ue,T,lt,we,X,rt]);t.useEffect((function(){var e,t=Qe.current;if(null!==ne){var a=[],n=[];if(X){var l=null===(e=ne.current)||void 0===e?void 0:e.children;setTimeout((function(){if(nt(l,a,v.length),nt(l,n,Ae),0!==n.length){var e=n.reduce((function(e,t){return e+t}));null!==re&&null!==t&&e>re&&(t.scrollTop=e)}}),100)}}}),[X,Ae]),t.useEffect((function(){var e,t=Qe.current;if(null!==ne){var a=[],n=[];if(X){var l=null===(e=ne.current)||void 0===e?void 0:e.children;setTimeout((function(){nt(l,a,v.length),nt(l,n,Ae+2);var e=a.reduce((function(e,t){return e+t})),r=n.reduce((function(e,t){return e+t})),c=ue.map((function(e,t){return u(u({},e),t===Ae?{active:!0}:{active:!1})}));oe(c),null!==re&&null!==t&&(Ge&&(t.scrollTop=r>re?r-re:0),Me&&(t.scrollTop=r<=re?r-76:e))}),100)}}}),[X,v,Ge,Me,nt,Ae,re]),t.useEffect((function(){return Ie&&window.addEventListener("keydown",ct),function(){window.removeEventListener("keydown",ct)}}),[Ie,ct]),t.useEffect((function(){if(T){var e=ue.filter((function(e){return e.selected&&!e.disabled})),t=ue.filter((function(e){return!e.disabled}));e.length!==t.length?Ne(!1):Ne(!0)}}),[ue,T]);return t.useMemo((function(){if(X&&C){var e=we.filter((function(e){return e.text.toLowerCase().includes(de.toLowerCase())}));0===e.length?oe([{text:F,className:"select-no-results"}]):oe(e)}}),[X,we,C,F,de]),c.default.createElement(y,{className:$e,ref:je},c.default.createElement(d,u({onFocus:function(){return ze(!0)},onBlur:function(){return ze(!1)},value:te,className:_e,labelClass:r.default(M?"select-input-label-active":"","select-label"),inputRef:Te,onClick:at,readOnly:!I,required:I,placeholder:w,disabled:S,wrapperStyle:{zIndex:0},label:O,"aria-expanded":!!X,"aria-disabled":!!S,"aria-haspopup":!0,role:"listbox"},H),void 0!==te&&te.length>0&&m&&c.default.createElement("span",{className:"select-clear-btn d-block",role:"button",onClick:function(){ae(""),ve(!1),oe(v.map((function(e){return u(u({},e),{active:!1,selected:!1})}))),Se(v.map((function(e){return u(u({},e),{active:!1,selected:!1})})))}},"✕"),c.default.createElement("span",{className:"select-arrow",style:{zIndex:-1}})),X&&i.default.createPortal(c.default.createElement(N,u({style:u(u({},Ye.popper),{width:G,zIndex:1070})},Ze.popper,{ref:Oe}),c.default.createElement(f,{open:$},C&&c.default.createElement("div",{className:"input-group"},c.default.createElement(d,{wrapperStyle:{width:"100%"},className:"select-filter-input placeholder-active",placeholder:j,role:"searchbox",type:"text",onKeyDown:ct,onChange:function(e){fe(e.target.value)},value:de,inputRef:We,"aria-label":D})),c.default.createElement(E,{ref:Qe,maxHeight:re},c.default.createElement(g,{ref:ne},T&&c.default.createElement(h,{onClick:function(){Ne(!ye)},selected:ye,height:38,text:A,multiple:!0}),ue.map((function(e,t){return c.default.createElement(h,{onClick:function(){return lt(e,t)},onChange:function(){return lt(e,t)},"data-value":e.value,active:e.active,className:e.className,height:e.height,style:e.style,selected:e.selected,key:e.text+t,disabled:e.disabled,secondaryText:e.secondaryText,text:e.text,revert:e.revert,multiple:T},e.icon&&c.default.createElement(p,null,"object"!=typeof e.icon||e.icon.constructor!==Object||c.default.isValidElement(e.icon)?e.icon:c.default.createElement(b,{className:e.icon.className,src:e.icon.src?e.icon.src:""},e.icon.text)))})),n&&c.default.createElement("div",{className:"select-custom-content"},n))))),document.body))};y.defaultProps={noResultLabel:"No results",optionSelected:"5",searchLabel:"Search...",selectAllLabel:"Select all",tag:"div",tagWrapper:"div",visibleOptions:5,size:"default",validation:!1,searchAriaLabel:"Search"},module.exports=y;
