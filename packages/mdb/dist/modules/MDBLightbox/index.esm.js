import e from"clsx";import t,{useRef as n,useState as r,useCallback as o,useEffect as l}from"react";import c from"react-dom";var a=function(){return a=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},a.apply(this,arguments)};var i=function(i){var u=i.className,s=i.tag,f=i.zoomLevel,m=i.fontAwesome,d=i.children,g=i.lightboxRef;i.onOpen;var h=i.onClose,y=i.onSlide,b=i.onZoomIn,v=i.onZoomOut,p=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n}(i,["className","tag","zoomLevel","fontAwesome","children","lightboxRef","onOpen","onClose","onSlide","onZoomIn","onZoomOut"]),x=e("lightbox",u),w=n(null),E=n(null),N=n(null),A=n(null),k=n(null),L=n(null),O=g||L,S=r(!1),F=S[0],q=S[1],C=r(0),j=C[0],z=C[1],P=r(!1),H=P[0],M=P[1],D=r([]),I=D[0],T=D[1],W=r(1),X=W[0],Y=W[1],Z=r(!1),R=Z[0],U=Z[1],V=r(""),B=V[0],G=V[1],J=n(),K=n(),Q=n(),$=n(),_=n(),ee=n(),te=function(e,t){var n=e;return n>t.length-1&&(n=0),t[n].classList.contains("lightbox-disabled")?te(n+1,t):n},ne=function(e,t){var n=e;return n<0&&(n=t.length-1),t[n].classList.contains("lightbox-disabled")?ne(n-1,t):n},re=o((function(e){if(F)switch(e.preventDefault(),e.key){case"ArrowLeft":E.current&&E.current.click();break;case"ArrowRight":N.current&&N.current.click();break;case"ArrowUp":case"ArrowDown":k.current&&k.current.click();break;case"Escape":A.current&&A.current.click();break;case"Home":z(0);break;case"End":I.length>0&&z(I.length-1)}}),[F,I]),oe=o((function(e,t){var n;document.body.classList.add("overflow-hidden"),q(!0),z(t),document.querySelectorAll(".lightbox-gallery-item").forEach((function(e){fe(e)}));var r=null===(n=w.current)||void 0===n?void 0:n.querySelector(".lightbox-gallery-item.active");G(null==r?void 0:r.getAttribute("alt"))}),[]),le=function(){var e=te(j+1,I);z(e),Y(1),U(!1),document.querySelectorAll(".lightbox-gallery-item").forEach((function(e){fe(e)})),setTimeout((function(){var e,t=null===(e=w.current)||void 0===e?void 0:e.querySelector(".lightbox-gallery-item.active");G(null==t?void 0:t.getAttribute("alt"))}),10),null==y||y()},ce=function(){var e=ne(j-1,I);z(e),Y(1),U(!1),document.querySelectorAll(".lightbox-gallery-item").forEach((function(e){fe(e)})),setTimeout((function(){var e,t=null===(e=w.current)||void 0===e?void 0:e.querySelector(".lightbox-gallery-item.active");G(null==t?void 0:t.getAttribute("alt"))}),10),null==y||y()},ae=o((function(){void 0===(document.webkitIsFullScreen||document.mozFullScreen||document.msFullscreenElement)&&M(!1)}),[]),ie=function(e){e.preventDefault();var t=e.touches,n=e.target,r=t?t[0].clientX:e.clientX,o=t?t[0].clientY:e.clientY;Q.current=parseFloat(n.style.left)||0,$.current=parseFloat(n.style.top)||0,J.current=parseFloat(n.style.left)||0,K.current=parseFloat(n.style.top)||0,_.current=r*(1/X)-J.current,ee.current=o*(1/X)-K.current,U(!0)},ue=function(e){if(R){var t=e.touches,n=t?t[0].clientX:e.clientX,r=t?t[0].clientY:e.clientY;if(1!==X)J.current=n*(1/X)-_.current,K.current=r*(1/X)-ee.current,e.target.style.left="".concat(J.current,"px"),e.target.style.top="".concat(K.current,"px");else{if(I.length<=1)return;J.current=n*(1/X)-_.current,e.target.style.left="".concat(J.current,"px")}}},se=function(){1===X&&(J.current>0?ce():J.current<0&&le()),U(!1)},fe=function(e){e.width>=e.height?(e.style.width="100%",e.style.maxWidth="100%",e.style.height="auto",e.style.top="".concat((e.parentNode.offsetHeight-e.height)/2,"px"),e.style.left=0):(e.style.height="100%",e.style.maxHeight="100%",e.style.width="auto",e.style.left="".concat((e.parentNode.offsetWidth-e.width)/2,"px"),e.style.top=0),e.width>=e.parentNode.offsetWidth&&(e.style.width="".concat(e.parentNode.offsetWidth,"px"),e.style.height="auto",e.style.left=0,e.style.top="".concat((e.parentNode.offsetHeight-e.height)/2,"px")),e.height>=e.parentNode.offsetHeight&&(e.style.height="".concat(e.parentNode.offsetHeight,"px"),e.style.width="auto",e.style.top=0,e.style.left="".concat((e.parentNode.offsetWidth-e.width)/2,"px")),J.current=parseFloat(e.style.left)||0,K.current=parseFloat(e.style.top)||0},me=o((function(){var e=O.current.querySelectorAll(".lightbox-item");T(e)}),[O]),de=o((function(e){for(var t=0,n=e;t<n.length;t++){"childList"===n[t].type&&me()}}),[me]);l((function(){me()}),[me]),l((function(){I.length>0&&document.querySelectorAll(".lightbox-gallery-item").forEach((function(e){fe(e)}))}),[I]);var ge=o((function(){document.querySelectorAll(".lightbox-gallery-item").forEach((function(e){fe(e)}))}),[]);return l((function(){window.addEventListener("resize",ge),window.addEventListener("keydown",(function(e){return re(e)})),window.addEventListener("fullscreenchange",ae);var e=new MutationObserver(de);return e.observe(O.current,{childList:!0,subtree:!0}),I.forEach((function(e,t){!e.classList.contains("lightbox-disabled")&&e.addEventListener("click",(function(e){return oe(e,t)}))})),function(){e.disconnect(),window.removeEventListener("resize",ge),window.removeEventListener("keydown",(function(e){return re(e)})),window.removeEventListener("fullscreenchange",ae),I.forEach((function(e,t){e.removeEventListener("click",(function(e){return oe(e,t)}))}))}}),[I,O,de,oe,ge,re,ae]),t.createElement(t.Fragment,null,t.createElement(s,a({ref:O,className:x},p),d),c.createPortal(t.createElement("div",{className:"lightbox-gallery",onClick:function(e){"DIV"===e.target.tagName&&(document.body.classList.remove("overflow-hidden"),q(!1),null==h||h())},ref:w,style:{opacity:F?1:0,pointerEvents:F?"initial":"none",visibility:F?"visible":"hidden"}},t.createElement("div",{className:"lightbox-gallery-loader"}),t.createElement("div",{className:"lightbox-gallery-toolbar"},t.createElement("div",{className:"lightbox-gallery-left-tools"},t.createElement("p",{className:"lightbox-gallery-counter"},"".concat(j+1," / ").concat(I.length))),t.createElement("div",{className:"lightbox-gallery-right-tools"},t.createElement("button",{className:"lightbox-gallery-fullscreen-btn ".concat("pro"===m&&"fontawesome-pro"," ").concat(H&&"active"),onClick:function(){var e;H?(document.exitFullscreen&&document.exitFullscreen(),M(!1)):((null===(e=w.current)||void 0===e?void 0:e.requestFullscreen)&&w.current.requestFullscreen(),M(!0))}}),t.createElement("button",{ref:k,className:"lightbox-gallery-zoom-btn ".concat("pro"===m&&"fontawesome-pro"," ").concat(X>1&&"active"),onClick:function(){return X>1?(Y(X-f),document.querySelectorAll(".lightbox-gallery-item").forEach((function(e){fe(e)})),void(null==v||v())):function(e){Y(X+e),null==b||b()}(f)}}),t.createElement("button",{className:"lightbox-gallery-close-btn ".concat("pro"===m&&"fontawesome-pro"),onClick:function(){H&&document.exitFullscreen&&document.exitFullscreen(),document.body.classList.remove("overflow-hidden"),q(!1),Y(1),U(!1),document.querySelectorAll(".lightbox-gallery-item").forEach((function(e){fe(e)})),null==h||h()},ref:A}))),t.createElement("div",{className:"lightbox-gallery-content"},Object.values(I).map((function(e,n){var r,o,l={source:(r=e).getAttribute("data-mdb-img")?r.getAttribute("data-mdb-img"):r.getAttribute("src")?r.getAttribute("src"):"",caption:r.getAttribute("data-mdb-caption")?r.getAttribute("data-mdb-caption"):r.getAttribute("alt")?r.getAttribute("alt"):""},c=l.source,a=l.caption,i=n===j?1:0,u=n===j?X:.25,s=j===I.length-1&&0===n,f=0===j&&n===I.length-1;return o=j<n&&!f&&!s?"100%":j>n&&!f&&!s||f?"-100%":s?"100%":"0%",t.createElement("div",{className:"lightbox-gallery-image",key:n,style:{position:"absolute",opacity:i,left:o,transform:"scale(".concat(u,")")}},t.createElement("img",{src:c,alt:a,onMouseDown:function(e){return ie(e)},onMouseMove:function(e){return ue(e)},onMouseUp:se,onTouchStart:function(e){return ie(e)},onTouchMove:function(e){return ue(e)},onTouchEnd:se,className:"lightbox-gallery-item ".concat(j===n&&"active")}))}))),t.createElement("div",{className:"lightbox-gallery-arrow-left"},t.createElement("button",{"aria-label":"Previous",className:"".concat("pro"===m?"fontawesome-pro":""),onClick:ce,ref:E})),t.createElement("div",{className:"lightbox-gallery-arrow-right"},t.createElement("button",{"aria-label":"Next",className:"".concat("pro"===m?"fontawesome-pro":""),onClick:le,ref:N})),t.createElement("div",{className:"lightbox-gallery-caption-wrapper"},t.createElement("p",{className:"lightbox-gallery-caption"},B))),document.body))};i.defaultProps={tag:"div",zoomLevel:1,fontAwesome:"free"};export{i as default};
