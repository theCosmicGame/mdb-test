"use strict";var e=require("react"),t=require("clsx"),a=require("react-popper"),n=require("@popperjs/core"),l=require("react-dom");function r(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var o=r(e),u=r(t),c=r(l),i=function(){return i=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var l in t=arguments[a])Object.prototype.hasOwnProperty.call(t,l)&&(e[l]=t[l]);return e},i.apply(this,arguments)};function s(e,t){var a={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(a[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var l=0;for(n=Object.getOwnPropertySymbols(e);l<n.length;l++)t.indexOf(n[l])<0&&Object.prototype.propertyIsEnumerable.call(e,n[l])&&(a[n[l]]=e[n[l]])}return a}var f=function(t){var a,n=t.className,l=t.size,r=t.contrast,c=t.value,f=t.defaultValue,d=t.id,p=t.labelClass,m=t.wrapperClass,v=t.wrapperStyle,h=t.wrapperTag,g=t.label,w=t.onChange,y=t.children,E=t.labelRef,b=t.labelStyle,N=t.inputRef,S=t.type,C=t.onBlur,k=t.readonly,O=s(t,["className","size","contrast","value","defaultValue","id","labelClass","wrapperClass","wrapperStyle","wrapperTag","label","onChange","children","labelRef","labelStyle","inputRef","type","onBlur","readonly"]),R=e.useState(c||f),P=R[0],j=R[1],x=e.useState(0),F=x[0],T=x[1],q=e.useState(!(!c&&!f)),H=q[0],L=q[1],V=e.useRef(null),z=e.useRef(null),I=E||V,A=N||z,D=u.default("form-outline",r&&"form-white",m),U=u.default("form-control",H&&"active","date"===S&&"active",l&&"form-control-".concat(l),n),B=u.default("form-label",p);e.useEffect((function(){void 0!==c&&L(!!c)}),[c]),e.useEffect((function(){void 0!==f&&L(!!f)}),[f]);var W=e.useCallback((function(){var e;(null===(e=I.current)||void 0===e?void 0:e.clientWidth)&&T(.8*I.current.clientWidth+8)}),[I]);e.useEffect((function(){W()}),[null===(a=I.current)||void 0===a?void 0:a.clientWidth,W]);return o.default.createElement(h,{className:D,style:v},o.default.createElement("input",i({type:S,readOnly:k,className:U,onBlur:function(e){L(""!==P),null==C||C(e)},onChange:function(e){j(e.target.value),null==w||w(e)},onFocus:W,value:c,defaultValue:f,id:d,ref:A},O)),g&&o.default.createElement("label",{className:B,style:b,htmlFor:d,ref:I},g),o.default.createElement("div",{className:"form-notch"},o.default.createElement("div",{className:"form-notch-leading"}),o.default.createElement("div",{className:"form-notch-middle",style:{width:F}}),o.default.createElement("div",{className:"form-notch-trailing"})),y)};f.defaultProps={wrapperTag:"div",readonly:!1};var d=o.default.forwardRef((function(e,t){var a=e.className,n=e.show,l=e.tag,r=e.children,c=s(e,["className","show","tag","children"]),f=u.default("autocomplete-dropdown",n&&"open",a);return o.default.createElement(l,i({className:f,ref:t},c),r)}));d.defaultProps={tag:"div"};var p=o.default.forwardRef((function(e,t){var a=e.className,n=e.tag,l=e.children,r=s(e,["className","tag","children"]),c=u.default("autocomplete-items-list",a);return o.default.createElement(n,i({className:c,ref:t},r),l)}));p.defaultProps={tag:"ul"};var m=o.default.forwardRef((function(e,t){var a=e.className,n=e.activeItem,l=e.tag,r=e.children,c=s(e,["className","activeItem","tag","children"]),f=u.default("autocomplete-item",n&&"active",a);return o.default.createElement(l,i({className:f,ref:t},c),r)}));m.defaultProps={tag:"li"};var v=function(t){var l=t.className,r=t.displayValue,u=t.dataFilter,v=t.threshold,h=t.itemContent,g=t.getFilteredData,w=t.listHeight,y=t.noResults,E=t.tag,b=t.customContent,N=t.onChange,S=t.onSelect,C=t.onClose,k=t.onOpen,O=t.onUpdate,R=s(t,["className","displayValue","dataFilter","threshold","itemContent","getFilteredData","listHeight","noResults","tag","customContent","onChange","onSelect","onClose","onOpen","onUpdate"]),P=e.useState(!1),j=P[0],x=P[1],F=e.useState(!1),T=F[0],q=F[1],H=e.useState(),L=H[0],V=H[1],z=e.useState(),I=z[0],A=z[1],D=e.useState(),U=D[0],B=D[1],W=e.useState(-1),K=W[0],G=W[1],J=e.useState([]),M=J[0],Q=J[1],X=e.useState(!1),Y=X[0],Z=X[1],$=e.useState(""),_=$[0],ee=$[1],te=a.usePopper(I,U,i({placement:"bottom-start",modifiers:[n.flip]},{})),ae=te.styles,ne=te.attributes;e.useEffect((function(){if(j){var e=u(_);!function(e){return!!e&&"function"==typeof e.then}(e)?Q(e):(Z(!0),e.then((function(e){Q(e),Z(!1)}))),O&&O(e)}}),[_,u,j,O]),e.useEffect((function(){g&&g(M)}),[g,M]);var le=e.useCallback((function(e){var t=I===e.target,a=e.target===U,n=U&&U.contains(e.target);t||a||n||q(!1)}),[I,U]),re=e.useCallback((function(){if(I){var e=window.getComputedStyle(I).getPropertyValue("width");V(e)}}),[I]);e.useEffect((function(){if(K>-1){var e=null==U?void 0:U.querySelector("ul");if(e){var t=e.offsetHeight,a=null==U?void 0:U.querySelectorAll("li");if(a){var n=a[K].offsetHeight,l=e.scrollTop,r=K*n,o=r+n>l+t,u=r<l;e.scrollTop=u?r:o?r-t+n:l}}}}),[K,U]);var oe=e.useCallback((function(e){if(j){var t=e.key;if("Escape"===t||"ArrowUp"===t&&e.altKey||"Tab"===t)return q(!1),void(I&&I.focus());switch(t){case"ArrowDown":K<M.length-1&&G(K+1);break;case"ArrowUp":K>0&&G(K-1);break;case"Home":G(0);break;case"End":G(M.length-1);break;case"Enter":if(K>-1){var a=M[K];ee(r?r(a):a),q(!1)}return;default:return}e.preventDefault()}}),[K,M,I,j,r]);return e.useEffect((function(){return window.addEventListener("click",le),window.addEventListener("resize",re),window.addEventListener("keydown",oe),function(){window.removeEventListener("click",le),window.removeEventListener("resize",re),window.removeEventListener("keydown",oe)}}),[le,re,oe]),e.useEffect((function(){j&&(G(-1),setTimeout((function(){q(!0)}),100))}),[j]),e.useEffect((function(){T||setTimeout((function(){x(!1)}),100)}),[T]),e.useEffect((function(){if(I){var e=window.getComputedStyle(I).width;V(e)}}),[I,j]),e.useEffect((function(){j?k&&k():C&&C()}),[j,C,k]),o.default.createElement(o.default.Fragment,null,o.default.createElement(f,i({value:_,onChange:function(e){x(!0),G(-1),ee(e.target.value),N&&N(e)},onFocus:function(){return x(!0)},className:l,inputRef:A},R),Y&&o.default.createElement("div",{className:"autocomplete-loader spinner-border"},o.default.createElement("span",{className:"sr-only"},"Loading..."))),j&&void 0!==v&&void 0!==_&&_.length>=v&&c.default.createPortal(o.default.createElement(E,i({className:"autocomplete-dropdown-container",ref:B,style:i(i({position:"absolute",zIndex:1065},ae.popper),{width:L})},ne.popper),o.default.createElement(d,{show:T},o.default.createElement(p,{role:"listbox",style:{maxHeight:"".concat(w,"px")}},0===M.length?o.default.createElement(m,{role:"option"},y):M.map((function(e,t){return o.default.createElement(m,{activeItem:K===t,key:r?r(e)+t:e+t,onClick:function(){null==I||I.focus(),ee(r?r(e):e),q(!1),S&&S(e)},role:"option"},h?h(e):r?r(e):e)}))),b&&b)),document.body))};v.defaultProps={tag:"div",threshold:0,noResults:"No results found",listHeight:190},module.exports=v;
