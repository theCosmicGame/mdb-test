import e from"clsx";import t,{useCallback as n,useEffect as i,useState as a,useRef as r,useContext as o}from"react";var l=function(){return l=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},l.apply(this,arguments)};function s(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(i=Object.getOwnPropertySymbols(e);a<i.length;a++)t.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(e,i[a])&&(n[i[a]]=e[i[a]])}return n}var c=t.createContext({activeItem:1,setActiveItem:null,prevActive:{current:1},setHeight:null,completed:[],noEditable:!1,isAnimating:{current:!1},linear:!1,formRef:{current:null},validate:{target:0,after:0},setValidate:null,type:"horizontal",stepsLength:0,onValid:void 0,onInvalid:void 0,mobileProgress:!1,disableHeadSteps:!1}),d=function(o){var c=o.animation,d=o.animationRef,u=o.className,m=o.children,p=o.delay,f=o.infinite,v=o.duration,g=o.enableTarget,y=o.target,h=o.repeatOnScroll,b=o.reset,w=o.setTarget,E=o.start,N=o.style,I=o.tag,S=s(o,["animation","animationRef","className","children","delay","infinite","duration","enableTarget","target","repeatOnScroll","reset","setTarget","start","style","tag"]),T=a(!!y),C=T[0],H=T[1],O=a(!1),V=O[0],x=O[1],L=r(!0),A=e(C&&"animation",C&&c,u),F=r(null),R=d||F,B=function(){H(!C)},P=n((function(){if(R.current){var e=R.current.getBoundingClientRect().top+document.body.scrollTop,t=R.current.offsetHeight,n=e<=window.innerHeight&&e+t>=0;n&&L.current?(L.current=!1,p?setTimeout((function(){H(!0),x(!0)}),p):(H(!0),x(!0))):!n&&h&&(x(!1),L.current=!0)}}),[R,h,p]);return i((function(){return"onScroll"===E&&window.addEventListener("scroll",P),function(){window.removeEventListener("scroll",P)}}),[P,E]),i((function(){H(!!y)}),[y]),i((function(){"onLoad"===E&&H(!0)}),[E]),i((function(){C&&!f&&b&&setTimeout((function(){H(!C),g&&w(!1)}),v)}),[C,v,g,w,f,b]),t.createElement(t.Fragment,null,"onClick"===E&&!1===g&&t.createElement(I,l({onClick:B,className:A,ref:R},S,{style:l(l({},N),{animationDuration:"".concat(v,"ms"),animationIterationCount:f?"infinite":null,animationDelay:p?"".concat(p,"ms"):null})}),m),"onHover"===E&&!1===g&&t.createElement(I,l({onMouseEnter:B,className:A,ref:R},S,{style:l(l({},N),{animationDuration:"".concat(v,"ms"),animationIterationCount:f?"infinite":null,animationDelay:p?"".concat(p,"ms"):null})}),m),("onLoad"===E||!0===g)&&t.createElement(I,l({className:A,ref:R},S,{style:l(l({},N),{animationDuration:"".concat(v,"ms"),animationIterationCount:f?"infinite":null,animationDelay:p?"".concat(p,"ms"):null})}),m),"onScroll"===E&&t.createElement(I,l({className:A,ref:R},S,{style:l(l({},N),{animationDuration:"".concat(v,"ms"),visibility:V?"visible":"hidden",animationIterationCount:f?"infinite":null})}),m))};d.defaultProps={enableTarget:!1,target:!1,tag:"div",start:"onClick",duration:500,animation:"slide-right"};var u=function(n){var r=n.itemId,s=n.children,u=n.className,m=n.style,p=o(c),f=p.activeItem,v=p.prevActive,g=a(r===f),y=g[0],h=g[1],b=a(!1),w=b[0],E=b[1],N=e("stepper-content","py-3",!y&&"stepper-content-hide",u),I=function(t,n,i){var a=i>n,r=i<n;return t?e(a&&"slide-out-left",r&&"slide-out-right"):e(a&&"slide-in-right",r&&"slide-in-left")}(w,v.current,f),S=l({display:y||w?"block":"none"},m);return i((function(){var e=v.current;r===e&&(E(!0),setTimeout((function(){E(!1)}),800))}),[r,v,f]),i((function(){h(r===f)}),[r,f]),t.createElement(d,{className:N,start:"onLoad",animation:I,duration:800,style:S},t.createElement("span",null,s))},m=function(l){var s=l.itemId,d=l.children,u=l.className,m=l.isValidated,p=l.style,f=o(c).activeItem,v=a(!0),g=v[0],y=v[1],h=e("stepper-content","py-3",!g&&"stepper-content-hide",u),b=r(null);return function(e){var t=e.stepRef,a=e.show,o=e.isValidated,l=r({paddingTop:0,paddingBottom:0}),s=n((function(){var e=t.current;if(e){var n;if(a)e.style.height="",n=e.scrollHeight;else{var i=l.current,r=i.paddingBottom,o=i.paddingTop;n=e.scrollHeight+r+o}e.style.height="".concat(n,"px")}}),[t,l,a]);i((function(){var e=t.current;if(e){var n=window.getComputedStyle(e),i=n.paddingTop,a=n.paddingBottom;l.current={paddingBottom:parseFloat(a),paddingTop:parseFloat(i)},e.style.height="".concat(e.scrollHeight,"px")}}),[t]),i((function(){return o&&setTimeout((function(){s()}),210),window.addEventListener("resize",s),function(){window.removeEventListener("resize",s)}}),[s,o])}({stepRef:b,show:g,isValidated:m}),i((function(){y(s===f)}),[s,f]),t.createElement("div",{style:p,className:h,ref:b},t.createElement("span",null,d))},p=function(d){var p=d.className,f=d.itemId,v=d.children,g=d.headIcon,y=d.headText,h=d.customValidation,b=d.headClassName,w=d.contentClassName,E=d.headStyle,N=d.contentStyle,I=s(d,["className","itemId","children","headIcon","headText","customValidation","headClassName","contentClassName","headStyle","contentStyle"]),S=o(c),T=S.activeItem,C=S.setActiveItem,H=S.setHeight,O=S.prevActive,V=S.completed,x=S.noEditable,L=S.linear,A=S.formRef,F=S.validate,R=S.setValidate,B=S.type,P=S.onInvalid,D=S.onValid,j=S.mobileProgress,k=S.isAnimating,q=S.disableHeadSteps,z=a(!1),M=z[0],G=z[1],J=a(!1),K=J[0],Q=J[1],U=V.includes(f),W=T===f,X=x&&U&&!W,Y=e("stepper-step",W&&"stepper-active",U&&"stepper-completed",X&&"stepper-disabled",L&&M&&"was-validated",K&&"stepper-invalid",p),Z=e("stepper-head",b),$=r(null),_=l({cursor:e(q&&"auto")},E);!function(e){var t=e.stepRef,a=e.setHeight,r=e.isActive,o=e.isValidated,l=e.isMobile,s=e.children,c=n((function(){var e,n,i,r=t.current,o=null==r?void 0:r.querySelector(".stepper-content"),s=o&&getComputedStyle(o),c=null===(e=null==r?void 0:r.parentNode)||void 0===e?void 0:e.querySelector(".stepper-mobile-footer"),d=c?getComputedStyle(c):"",u=(i=l?null===(n=null==r?void 0:r.parentNode)||void 0===n?void 0:n.querySelector(".stepper-mobile-head"):null==r?void 0:r.querySelector(".stepper-head"))&&getComputedStyle(i),m=(null==o?void 0:o.offsetHeight)+parseFloat(null==s?void 0:s.marginTop)+parseFloat(null==s?void 0:s.marginBottom),p=(null==i?void 0:i.offsetHeight)+parseFloat(null==u?void 0:u.marginTop)+parseFloat(null==u?void 0:u.marginBottom),f=d?(null==c?void 0:c.offsetHeight)+parseFloat(null==d?void 0:d.marginTop)+parseFloat(null==d?void 0:d.marginBottom):0;a(p+m+f)}),[a,t,l]);i((function(){if(r)return setTimeout((function(){c()}),10),o&&setTimeout((function(){c()}),210),window.addEventListener("resize",c),function(){window.removeEventListener("resize",c)}}),[r,c,o]),i((function(){c()}),[s,c])}({stepRef:$,setHeight:H,isActive:W,isValidated:M,isMobile:"mobile"===B,children:v});return i((function(){var e=F.target,t=F.after;if(f===e&&L){if(t<e)return O.current=e,void C(t);var n=$.current,i=A.current;null==i||i.classList.add("was-validated");var a=function(e,t){return Array.from(e.querySelectorAll("input[required]")).every((function(e){return t?t(e):e.checkValidity()}))}(n,h);G(!0),Q(!a),a?(null==D||D(f),null==i||i.classList.remove("was-validated"),O.current=e,C(t)):null==P||P(f)}}),[F,f,A,L,C,O,D,P,h]),t.createElement("li",l({ref:$,className:Y},I),!j&&t.createElement("div",{className:Z,tabIndex:W?0:-1,onClick:function(){var e=k.current&&"vertical"!==B&&T!==O.current;X||W||q||e||(L?R({target:T,after:f}):(O.current=T,C(f)))},style:_},t.createElement("span",{className:"stepper-head-icon"},g),t.createElement("span",{className:"stepper-head-text"},y)),"vertical"===B?t.createElement(m,{style:N,className:w,isValidated:M,itemId:f},v):t.createElement(u,{style:N,className:w,itemId:f},v))};p.defaultProps={icon:0,text:"none"};export{p as default};
